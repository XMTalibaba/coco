"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.isValidResourceName = isValidResourceName;
exports.AuthType = exports.ERROR_MISSING_ROLE_PATH = exports.API_AUTH_LOGOUT = exports.API_AUTH_LOGIN = exports.CUSTOM_ERROR_PAGE_URI = exports.LOGIN_PAGE_URI = exports.API_ENDPOINT_AUTHINFO = exports.CONFIGURATION_API_PREFIX = exports.API_PREFIX = exports.APP_ID_CUSTOMERROR = exports.APP_ID_LOGIN = exports.PLUGIN_NAME = exports.PLUGIN_ID = void 0;

/*
 *   Copyright 2020 Amazon.com, Inc. or its affiliates. All Rights Reserved.
 *
 *   Licensed under the Apache License, Version 2.0 (the "License").
 *   You may not use this file except in compliance with the License.
 *   A copy of the License is located at
 *
 *       http://www.apache.org/licenses/LICENSE-2.0
 *
 *   or in the "license" file accompanying this file. This file is distributed
 *   on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either
 *   express or implied. See the License for the specific language governing
 *   permissions and limitations under the License.
 */
const PLUGIN_ID = 'opendistroSecurity';
exports.PLUGIN_ID = PLUGIN_ID;
const PLUGIN_NAME = 'opendistro_security';
exports.PLUGIN_NAME = PLUGIN_NAME;
const APP_ID_LOGIN = 'login';
exports.APP_ID_LOGIN = APP_ID_LOGIN;
const APP_ID_CUSTOMERROR = 'customerror';
exports.APP_ID_CUSTOMERROR = APP_ID_CUSTOMERROR;
const API_PREFIX = '/api/v1';
exports.API_PREFIX = API_PREFIX;
const CONFIGURATION_API_PREFIX = 'configuration';
exports.CONFIGURATION_API_PREFIX = CONFIGURATION_API_PREFIX;
const API_ENDPOINT_AUTHINFO = API_PREFIX + '/auth/authinfo';
exports.API_ENDPOINT_AUTHINFO = API_ENDPOINT_AUTHINFO;
const LOGIN_PAGE_URI = '/app/' + APP_ID_LOGIN;
exports.LOGIN_PAGE_URI = LOGIN_PAGE_URI;
const CUSTOM_ERROR_PAGE_URI = '/app/' + APP_ID_CUSTOMERROR;
exports.CUSTOM_ERROR_PAGE_URI = CUSTOM_ERROR_PAGE_URI;
const API_AUTH_LOGIN = '/auth/login';
exports.API_AUTH_LOGIN = API_AUTH_LOGIN;
const API_AUTH_LOGOUT = '/auth/logout';
exports.API_AUTH_LOGOUT = API_AUTH_LOGOUT;
const ERROR_MISSING_ROLE_PATH = '/missing-role';
exports.ERROR_MISSING_ROLE_PATH = ERROR_MISSING_ROLE_PATH;
let AuthType;
/**
 * A valid resource name should not containing percent sign (%) as they raise url injection issue.
 * And also should not be empty.
 * @param resourceName resource name to be validated
 */

exports.AuthType = AuthType;

(function (AuthType) {
  AuthType["BASIC"] = "basicauth";
  AuthType["OPEN_ID"] = "openid";
  AuthType["JWT"] = "jwt";
  AuthType["SAML"] = "saml";
  AuthType["PROXY"] = "proxy";
})(AuthType || (exports.AuthType = AuthType = {}));

function isValidResourceName(resourceName) {
  // see: https://javascript.info/regexp-unicode
  return !/[\p{C}%]/u.test(resourceName) && resourceName.length > 0;
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImluZGV4LnRzIl0sIm5hbWVzIjpbIlBMVUdJTl9JRCIsIlBMVUdJTl9OQU1FIiwiQVBQX0lEX0xPR0lOIiwiQVBQX0lEX0NVU1RPTUVSUk9SIiwiQVBJX1BSRUZJWCIsIkNPTkZJR1VSQVRJT05fQVBJX1BSRUZJWCIsIkFQSV9FTkRQT0lOVF9BVVRISU5GTyIsIkxPR0lOX1BBR0VfVVJJIiwiQ1VTVE9NX0VSUk9SX1BBR0VfVVJJIiwiQVBJX0FVVEhfTE9HSU4iLCJBUElfQVVUSF9MT0dPVVQiLCJFUlJPUl9NSVNTSU5HX1JPTEVfUEFUSCIsIkF1dGhUeXBlIiwiaXNWYWxpZFJlc291cmNlTmFtZSIsInJlc291cmNlTmFtZSIsInRlc3QiLCJsZW5ndGgiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7O0FBQUE7Ozs7Ozs7Ozs7Ozs7O0FBZU8sTUFBTUEsU0FBUyxHQUFHLG9CQUFsQjs7QUFDQSxNQUFNQyxXQUFXLEdBQUcscUJBQXBCOztBQUVBLE1BQU1DLFlBQVksR0FBRyxPQUFyQjs7QUFDQSxNQUFNQyxrQkFBa0IsR0FBRyxhQUEzQjs7QUFFQSxNQUFNQyxVQUFVLEdBQUcsU0FBbkI7O0FBQ0EsTUFBTUMsd0JBQXdCLEdBQUcsZUFBakM7O0FBQ0EsTUFBTUMscUJBQXFCLEdBQUdGLFVBQVUsR0FBRyxnQkFBM0M7O0FBQ0EsTUFBTUcsY0FBYyxHQUFHLFVBQVVMLFlBQWpDOztBQUNBLE1BQU1NLHFCQUFxQixHQUFHLFVBQVVMLGtCQUF4Qzs7QUFDQSxNQUFNTSxjQUFjLEdBQUcsYUFBdkI7O0FBQ0EsTUFBTUMsZUFBZSxHQUFHLGNBQXhCOztBQUVBLE1BQU1DLHVCQUF1QixHQUFHLGVBQWhDOztJQUVLQyxRO0FBUVo7Ozs7Ozs7O1dBUllBLFE7QUFBQUEsRUFBQUEsUTtBQUFBQSxFQUFBQSxRO0FBQUFBLEVBQUFBLFE7QUFBQUEsRUFBQUEsUTtBQUFBQSxFQUFBQSxRO0dBQUFBLFEsd0JBQUFBLFE7O0FBYUwsU0FBU0MsbUJBQVQsQ0FBNkJDLFlBQTdCLEVBQTREO0FBQ2pFO0FBQ0EsU0FBTyxDQUFDLFlBQVlDLElBQVosQ0FBaUJELFlBQWpCLENBQUQsSUFBbUNBLFlBQVksQ0FBQ0UsTUFBYixHQUFzQixDQUFoRTtBQUNEIiwic291cmNlc0NvbnRlbnQiOlsiLypcbiAqICAgQ29weXJpZ2h0IDIwMjAgQW1hem9uLmNvbSwgSW5jLiBvciBpdHMgYWZmaWxpYXRlcy4gQWxsIFJpZ2h0cyBSZXNlcnZlZC5cbiAqXG4gKiAgIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIikuXG4gKiAgIFlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqICAgQSBjb3B5IG9mIHRoZSBMaWNlbnNlIGlzIGxvY2F0ZWQgYXRcbiAqXG4gKiAgICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiAgIG9yIGluIHRoZSBcImxpY2Vuc2VcIiBmaWxlIGFjY29tcGFueWluZyB0aGlzIGZpbGUuIFRoaXMgZmlsZSBpcyBkaXN0cmlidXRlZFxuICogICBvbiBhbiBcIkFTIElTXCIgQkFTSVMsIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXJcbiAqICAgZXhwcmVzcyBvciBpbXBsaWVkLiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmdcbiAqICAgcGVybWlzc2lvbnMgYW5kIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cbmV4cG9ydCBjb25zdCBQTFVHSU5fSUQgPSAnb3BlbmRpc3Ryb1NlY3VyaXR5JztcbmV4cG9ydCBjb25zdCBQTFVHSU5fTkFNRSA9ICdvcGVuZGlzdHJvX3NlY3VyaXR5JztcblxuZXhwb3J0IGNvbnN0IEFQUF9JRF9MT0dJTiA9ICdsb2dpbic7XG5leHBvcnQgY29uc3QgQVBQX0lEX0NVU1RPTUVSUk9SID0gJ2N1c3RvbWVycm9yJztcblxuZXhwb3J0IGNvbnN0IEFQSV9QUkVGSVggPSAnL2FwaS92MSc7XG5leHBvcnQgY29uc3QgQ09ORklHVVJBVElPTl9BUElfUFJFRklYID0gJ2NvbmZpZ3VyYXRpb24nO1xuZXhwb3J0IGNvbnN0IEFQSV9FTkRQT0lOVF9BVVRISU5GTyA9IEFQSV9QUkVGSVggKyAnL2F1dGgvYXV0aGluZm8nO1xuZXhwb3J0IGNvbnN0IExPR0lOX1BBR0VfVVJJID0gJy9hcHAvJyArIEFQUF9JRF9MT0dJTjtcbmV4cG9ydCBjb25zdCBDVVNUT01fRVJST1JfUEFHRV9VUkkgPSAnL2FwcC8nICsgQVBQX0lEX0NVU1RPTUVSUk9SO1xuZXhwb3J0IGNvbnN0IEFQSV9BVVRIX0xPR0lOID0gJy9hdXRoL2xvZ2luJztcbmV4cG9ydCBjb25zdCBBUElfQVVUSF9MT0dPVVQgPSAnL2F1dGgvbG9nb3V0JztcblxuZXhwb3J0IGNvbnN0IEVSUk9SX01JU1NJTkdfUk9MRV9QQVRIID0gJy9taXNzaW5nLXJvbGUnO1xuXG5leHBvcnQgZW51bSBBdXRoVHlwZSB7XG4gIEJBU0lDID0gJ2Jhc2ljYXV0aCcsXG4gIE9QRU5fSUQgPSAnb3BlbmlkJyxcbiAgSldUID0gJ2p3dCcsXG4gIFNBTUwgPSAnc2FtbCcsXG4gIFBST1hZID0gJ3Byb3h5Jyxcbn1cblxuLyoqXG4gKiBBIHZhbGlkIHJlc291cmNlIG5hbWUgc2hvdWxkIG5vdCBjb250YWluaW5nIHBlcmNlbnQgc2lnbiAoJSkgYXMgdGhleSByYWlzZSB1cmwgaW5qZWN0aW9uIGlzc3VlLlxuICogQW5kIGFsc28gc2hvdWxkIG5vdCBiZSBlbXB0eS5cbiAqIEBwYXJhbSByZXNvdXJjZU5hbWUgcmVzb3VyY2UgbmFtZSB0byBiZSB2YWxpZGF0ZWRcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGlzVmFsaWRSZXNvdXJjZU5hbWUocmVzb3VyY2VOYW1lOiBzdHJpbmcpOiBib29sZWFuIHtcbiAgLy8gc2VlOiBodHRwczovL2phdmFzY3JpcHQuaW5mby9yZWdleHAtdW5pY29kZVxuICByZXR1cm4gIS9bXFxwe0N9JV0vdS50ZXN0KHJlc291cmNlTmFtZSkgJiYgcmVzb3VyY2VOYW1lLmxlbmd0aCA+IDA7XG59XG4iXX0=